# Тесты к курсу «Основы программирования»

Условия лабораторных работ вы можете найти в таблице курса.

Порядок запуска локального тестирования:

1. Склонировать этот репозиторий
2. Скомпилировать разработанную программу
3. Проверить, что создался исполняемый файл (в Windows по умолчанию это `a.exe`, в Linux - `a.out`)
4. В каталоге, в котором находится этот файл, выполнить команду:

    ```bash
    python <путь к main.py> --program [a.exe|a.out|<другое название исполняемого файла>] --suite <выбор задания>
    ```

5. Для ускорения отладки рекомендуется сделать скрипт, выполняющий шаги 2-4.

## Лабораторные работы

Ниже представлена таблица доступных для тестирования (как локально, так и автоматически в репозиториях) лабораторных работ с названием набора тестов для тестера (`suite`).

| №  | Лабораторная работа | Набор тестов        |
|:--:|:--------------------|:--------------------|
| 0  | Сумма чисел         | `sum`               |
| 1  | Обратная матрица    | `invertible-matrix` |

## Скрипт запуска

> [!NOTE]
> Вы можете запустить команду `python main.py --help` для получения справочной информации.

Тестер выполняет тестирование программы методом "чёрного ящика", то есть на вход *input* программа выдаёт какой-то выход *output*, который должен быть правильным с точки зрения текущего теста. Необходимыми и достаточными параметрами [`main.py`](main.py) являются:

* `--program <path/to/executable>` - путь к исполняемому файлу;
* `--suite <name>` - выбор задания.

В случае, если хочется проверить программу только на правильность возвращаемых кодов возврата:

* `--check-output [True|False]` - включение/отключение проверки выходного значения порождённого процесса программы (по умолчанию - `True`).

Поскольку разные анализаторы и санитайзеры могут замедлить вашу программу (например, [Valgrind](https://valgrind.org/) с выбранным `memcheck` замедляет программу в 10-30 раз), то имеет смысл установить множитель максимального времени исполнения процесса на все тесты:

* `--timeout-factor <float>` - множитель максимального времени исполнения порождённого процесса программы (по умолчанию - `1.0`).

### JSON отчёт

Тестер также может сгенерировать полный отчёт в формате JSON. Необходимым и достаточным параметром является:

* `--json-quick [True|False]` - включение/отключение автоматической генерации необходимых для генерации JSON отчёта полей и файла вывода (по умолчанию - `False`).

Для более тонкой и идейно верной настройки доступны следующие флаги (все они требуют наличие флага `--json-output-name`):

* `--json-output-name <string>` - наименование файла при генерации JSON файла;
* `--json-target-system <string>` - *идейно* настоящее название системы для генерации отчёта JSON;
* `--json-use-compiler <string>` - *идейно* настоящее название использованного компилятора сборки для генерации отчёта JSON;
* `--json-build-type <string>` - *идейно* тип сборки программы для генерации отчёта JSON;
* `--json-final-results [True|False]` - активация вывода финальной суммы по категориальным весам (требуются установленные переменные окружения) в отчёт JSON (по умолчанию - `False`).

## Виртуальная среда Python

Для тестирования рекомендуется создать *виртуальную среду* `venv` и тестироваться через неё. Таким образом, можно поднять уровень изоляции от всей системы и избежать установки конфликтующих библиотек:

* создание новой среды:

    ```bash
    python -m venv venv
    ```

* активация текущей командной строки как `venv`:

    ```bash
    source ./venv/bin/activate
    # на Linux/MacOS (Bash)
    ```

    ```powershell
    .\venv\Scripts\Activate.ps1
    # на Windows (Powershell)
    ```

    ```bat
    .\venv\Scripts\activate.bat
    REM на Windows (CMD)
    ```

* установка всех необходимых для тестирования библиотек:

    ```bash
    ./venv/bin/pip3 install -r requirements.txt
    # на Linux/MacOS
    ```

    ```powershell
    .\venv\Scripts\pip3.exe install -r requirements.txt
    # на Windows
    ```

* запуск основного скрипта:

    ```bash
    ./venv/bin/python <путь к main.py> --program <путь к исполняемому файлу> --suite <выбор задания>
    # на Linux/MacOS
    ```

    ```powershell
    .\venv\Scripts\python.exe <путь к main.py> --program <путь к исполняемому файлу> --suite <выбор задания>
    # на Windows
    ```
